# ТЗ

##Цель:

Разработать бота, позволяющего пользователям добавить его в группу и играть в мафию (бот - ведущий).

##Основные команды бота:

- `/start`
- `/start_game`
- `/rules`

##Действия бота:

- По команде `/start` **в группе** бот присылает приветственное сообщение и просит всех написать ему команду `/start` в личке, если они этого ещё не делали.


- По команде `/start` **в личке** бот добавляет пользователя в БД.


- По команде `/start_game` просит пользователей подтвердить своё участие в игре, на это даётся 30 сек (минимум 6 человек).


- Проверяет, все ли участники есть в БД, если нет, просит их написать ему в личке `/start`.


- Отправляет в личку роли (мирный житель, мафия, комиссар; доктор, маньяк - опционально) и записывает в новую таблицу роли игроков и их составляющие.


- Мафии сообщает имена других игроков с ролью мафия.


- Отправляет мафии в личку кнопки с именами игроков, которых можно убить (все, кроме мафии и убитых) и даёт время обсудить через бота и выбрать (1 мин).


- Присылает комиссару список проверенных игроков и их роли и список живых непроверенных игроков, комиссар за 30 сек выбирает, кого хочет проверить, и бот отвечает (мафия или не мафия).


- Присылает доктору список живых игроков, которых можно лечить, доктор за 30 сек выбирает, кого хочет вылечить (себя можно только 1 раз за игру, другого нельзя 2 раза подряд).


- Присылает маньяку список живых игроков, он за 30 сек выбирает, кого хочет убить.


- Выбор каждого бот записывает в специальную колонку.


- Собирает статистику из выбора мафии (за кого больше).


- Подытоживает выборы игроков и, если нужно, записывает игроков в БД убитыми.


- В группе сообщает игрокам, кого убили ночью, и даёт время на обсуждение в группе (3 мин).


- Через 3 минуты появляется сообщение с кнопками для голосования на 30 сек.


- Подсчитывает голоса игроков и объявляет результат, сообщает, был ли игрок мафией, и исключает его из игры.


- Проверяет, не закончилась ли игра (кол-во мафии == кол-во игроков или больше нет мафии и маньяка или 1 маньяк). 


- И снова ночь...


- Если роль убита, бот всё равно объявляет её (пишет в группу, что игрок выбирает или выбрал кого-то).


- Если пользователь не участвует в игре или его убили, все его сообщения удаляются.
